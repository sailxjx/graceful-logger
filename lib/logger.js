// Generated by CoffeeScript 1.6.3
(function() {
  var Logger, colors;

  colors = require('colors');

  Logger = (function() {
    Logger.prototype.format = function() {
      var ft, i, matches, msgs, replaces, v;
      msgs = (function() {
        var _results;
        _results = [];
        for (i in arguments) {
          v = arguments[i];
          _results.push(v);
        }
        return _results;
      }).apply(this, arguments);
      if ((this.options.format != null) && typeof this.options.format === 'string') {
        matches = this.options.format.split(' ');
        replaces = {
          '%s': function(i) {
            i = Number(i);
            return matches = matches.slice(0, +(i - 1) + 1 || 9e9).concat(msgs, matches.slice(i + 1));
          },
          '%t': function(i) {
            return matches[i] = new Date;
          }
        };
        for (i in matches) {
          ft = matches[i];
          if (replaces[ft] != null) {
            replaces[ft].call(this, i);
          }
        }
        msgs = matches;
      }
      return msgs;
    };

    function Logger(options) {
      this.options = options != null ? options : {};
      this.level = 'info';
      this.prefixs = {
        info: 'info:',
        warn: 'WARN:',
        err: 'ERR!:'
      };
      this.levels = {
        info: {
          color: 'green',
          method: console.log
        },
        warn: {
          color: 'yellow',
          method: console.warn
        },
        err: {
          color: 'red',
          method: console.error
        }
      };
    }

    Logger.prototype._log = function() {
      var msgs;
      if (typeof this.options.custom === 'function') {
        return this.options.custom.apply(this, arguments);
      }
      this.prefix = process.stdout.isTTY ? this.prefixs[this.level][this.levels[this.level].color] : this.prefixs[this.level];
      msgs = this.format.apply(this, arguments);
      msgs.unshift(this.prefix);
      return this.levels[this.level].method.apply(this, msgs);
    };

    Logger.prototype.info = function() {
      this.level = 'info';
      return this._log.apply(this, arguments);
    };

    Logger.prototype.warn = function() {
      this.level = 'warn';
      return this._log.apply(this, arguments);
    };

    Logger.prototype.err = function() {
      var args, code, i, len, v;
      this.level = 'err';
      len = arguments.length;
      if (typeof arguments[len - 1] === 'number') {
        args = (function() {
          var _results;
          _results = [];
          for (i in arguments) {
            v = arguments[i];
            _results.push(v);
          }
          return _results;
        }).apply(this, arguments);
        code = args[len - 1];
        args.pop();
      } else {
        args = arguments;
      }
      this._log.apply(this, args);
      if (code != null) {
        return process.exit(code);
      }
    };

    return Logger;

  })();

  module.exports = Logger;

}).call(this);
